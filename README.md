## Script: `scripts/stratified_statistical_analysis.py`

### Description
Performs statistical analysis (Spearman, ANOVA, Chi-square) between internet-related exposures, demographic covariates, and dependent variables, stratified by marital status ("Married" and "Single"). Summarizes key findings and generates a well-formatted MS Word document.

### Inputs
- `outputs_internet/married/relation_summary_with_fdr.csv`: FDR-corrected summary of pairwise test results for married females (generated by `relationship_analysis_internet.py`).
- `outputs_internet/single/relation_summary_with_fdr.csv`: FDR-corrected summary of pairwise test results for single females (generated by `relationship_analysis_internet.py`).

### Outputs
- `outputs/stratified_statistical_analysis.docx`: MS Word document summarizing the key statistical findings for both groups, with thesis-style commentary on the strength, direction, and significance of relationships.

### Usage
```
python3 scripts/stratified_statistical_analysis.py
```

No command-line arguments are required; the script automatically reads the group summary files and generates the combined report.
## PhD-Jaya — Scales Data analysis

This repository contains scripts and data for exploratory analysis of the Scales dataset.

Quick overview
- Input data: `InputData/` (CSV/ODS files). The main working file used in scripts is:
  - `InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv`
- Scripts: `scripts/analysis_scales.py`, `scripts/normalize_income.py`, `scripts/produce_report.py`
- Outputs:
  - Summary CSVs: `scales_summary.csv`, `numeric_stats.csv`, `categorical_summary.csv`
  - Plots (local, not committed): `outputs/plots/` (PNG files)
  - Consolidated report PDF (tracked): `scales_plots_report.pdf`

Dependencies
- Python 3.8+ (or later)
- Required packages (install into a virtualenv):

```bash
pip install pandas numpy matplotlib seaborn
```

How to run

Recommended order (automates the workflow):

1) Normalize income (creates `-IncomeNormalized.csv` in the same folder):

```bash
cd /home/pranav/PhD-Jaya
python3 scripts/normalize_income.py InputData/20251214-ScalesData-Combined_ver0.7-Cleaned.csv
```

2) Run analysis on the income-normalized CSV:

```bash
python3 scripts/analysis_scales.py InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv
```

3) Produce plots and consolidated PDF report (from the normalized file):

```bash
python3 scripts/produce_report.py InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv
```
- Primary outputs (saved under `InputData/` by default):
  - `InputData/scales_plots_report.pdf` — consolidated PDF with one page per variable (box/hist/category plots and short summaries).
  - `InputData/outputs/plots/` — individual high-resolution PNG files (one per plot). These are not committed to git by default.

- Optional Word export (DOCX):
  - If `python-docx` is installed in the environment, the script also writes `InputData/scales_plots_report.docx` (mirrors the PDF content and embeds the PNGs).
  - To enable: `pip install --user python-docx`
  
  
4) Remove outliers and regenerate plots/PDF into a separate outputs folder:

```bash
python3 scripts/remove_outliers_and_regen.py InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv
```

This helper produces:

- `InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized-NoOutliers.csv`
- `InputData/outputs_nooutliers/plots/` (individual PNGs)
- `InputData/scales_plots_report_nooutliers.pdf`


5) relational tests and relation report 

```bash
python3 scripts/relational_analysis.py \
  InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized-NoOutliers.csv
```

Produces: `relation_summary.csv, relation_summary_with_fdr.csv, relation_report.pdf` (and outputs_relation for its plots). It may also create adjusted_models_summary.csv for regression checks.

Inputs for relational_analysis.py:

Any analysis-ready CSV (e.g. `InputData/...-IncomeNormalized-analysis-ready.csv`), or the NoOutliers CSV if you want cleaned-data relationships.
It expects the usual variable names present from analysis_scales.py output.
Outputs written by `relational_analysis.py` (default locations):

`relation_summary.csv` — raw pairwise test results
`relation_summary_with_fdr.csv` — same with Benjamini–Hochberg FDR applied
`relation_report.pdf ` — compiled plots/images showing relationships
`outputs_relation` — directory with individual relation plots (PNG)



Notes & recommendations
- Scripts accept an explicit path to a CSV file. If you run them without arguments they will use the repository's default `InputData/` filenames (created during the analysis session).
- The `outputs/plots/` folder is `.gitignore`d so PNGs are kept local. The consolidated PDF report `scales_plots_report.pdf` is tracked in git.
- If you'd like scripts to auto-detect the newest `ScalesData` file in `InputData/` instead of using a hard-coded filename, I can update them to do so.


# Thesis Documentation Scripts

The following scripts generate MS Word (DOCX) documents summarizing the findings and outcomes for thesis reporting:

### 1. `write_thesis_descriptive.py`
**Purpose:** Generates a descriptive analysis report with study objectives, variables, and summary statistics.

**Inputs:**
- Main cleaned/normalized CSV (default: `InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv`)
- Uses summary CSVs: `scales_summary.csv`, `numeric_stats.csv`, `categorical_summary.csv`

**Outputs:**
- `InputData/thesis_descriptive_analysis.docx` — Word document with descriptive statistics and commentary.

**Parameters:**
- No required command-line arguments; uses default file paths. Edit script to change input/output locations.

### 2. `write_thesis_analysis.py`
**Purpose:** Produces a DOCX report summarizing regression and analytical findings, including key results and interpretations.

**Inputs:**
- Main cleaned/normalized CSV (default: `InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv`)
- Regression/analysis outputs: e.g., `relation_summary.csv`, `relation_summary_with_fdr.csv`, and model summary files.

**Outputs:**
- `InputData/thesis_analysis_internet.docx` — Word document with regression/analysis results and thesis-style commentary.

**Parameters:**
- No required command-line arguments; uses default file paths. Edit script to change input/output locations.

### 3. `batch_ols_internet.py`
**Purpose:** Runs batch OLS regressions for internet-related exposures vs. outcomes, adjusting for covariates, and generates a DOCX summary.

**Inputs:**
- Analysis-ready CSV file (e.g., `InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv`)

**Outputs:**
- `InputData/batch_ols_report.docx` — Word summary of top OLS associations and model tables.
- `InputData/adjusted_models_batch_summary.csv` — CSV with model results.
- `InputData/outputs_models/plots/` — Plots for top associations.

**Parameters:**
- Path to input CSV file (required):
  ```bash
  python3 scripts/batch_ols_internet.py InputData/20251214-ScalesData-Combined_ver0.7-Cleaned-IncomeNormalized.csv
  ```

---

Contact / reproducibility
- To reproduce on another machine: clone the repo, create a Python virtual environment, install the dependencies above, and run the scripts as shown.

License
- Contents are project-specific; add an appropriate LICENSE file if you plan to publish.
